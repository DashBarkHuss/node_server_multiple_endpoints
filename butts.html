<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script type="module">
    function makePayload(payload){
      return { method: 'post',
        headers: {
        'Accept': 'application/json'
        },
        body: JSON.stringify(payload)
      }
    }
    class Butt {
      constructor() {}
    }
    Butt.find = function (shape) {
      console.log("user.butt");
      fetch('/api/butt/find',
        makePayload({shape: shape})
      ).then(promise => promise.json())
        .then(json => {
          if (json[json.length-1].success){
            console.log(json);
            for (var i=0; i<(json.length-1); i++) {
              console.log(i);
              const owner = json[i].owner;
              const buttDiv = document.querySelector('#returnedButts');
              if (i == 0) buttDiv.innerHTML = "";
              i == (json.length-2)?  buttDiv.innerHTML += owner + ".":buttDiv.innerHTML += owner + ", ";
              
            }
          }
          else
            console.log(`something went wrong: `, json);
        });
    }

    Butt.add = function(owner,shape){
      fetch('api/butt/add', 
      makePayload({owner: owner, shape:shape})
      ).then(promise => promise.json())
      .then(json =>
        console.log(json)
      )
    }
    
    window.onload = () => {
            window.Butt = Butt;
        }
    
  </script>
</head>

<body>
  <h1>Butt Finder</h1>
  Select shape of butt
  <input type="button" onclick="Butt.find('round')" value="round"></input>
  <input type="button" onclick="Butt.find('flat')" value="flat"></input>
  <input type="button" onclick="Butt.find('square')" value="square"></input>
  <p id='returnedButts'></p>

  <h2>Add Butt</h2>
  <p>Owner: <input id="owner"></input></p>
  <p>Shape: <input id="shape"></input></p>
  <input type="button" onClick="Butt.add(window.owner.value, window.shape.value)" value="Add"></input>
</body>

</html>